import{j as a,a as e,m as B,f as E,v as O,n as y,L as I}from"./index-5d5c5b17.js";import{r as h}from"./vendor-08663a87.js";import{P as ee,i as V,a1 as te,a2 as ae,a3 as se,a4 as re,e as F,a5 as K,a6 as q,a7 as X,g as Q,O as j,a8 as M,_ as z,s as G,o as le}from"./ui-529afc54.js";import{p as T}from"./propertyService-21dd88c7.js";const ie=({properties:s,loading:b=!1,onAddProperty:g,onEditProperty:v,onDeleteProperty:N,onViewProperty:P,onToggleFavorite:f})=>{const[o,S]=h.useState(""),[p,C]=h.useState(!1),[x,l]=h.useState("grid"),[n,d]=h.useState("created"),[m,H]=h.useState("desc"),[L,_]=h.useState(new Set),[c,w]=h.useState({}),$=[...s.filter(t=>{var u,k,D,A;const r=!o||t.title.toLowerCase().includes(o.toLowerCase())||t.address.toLowerCase().includes(o.toLowerCase())||t.district.toLowerCase().includes(o.toLowerCase()),i=(!((u=c.type)!=null&&u.length)||c.type.includes(t.type))&&(!((k=c.status)!=null&&k.length)||c.status.includes(t.status))&&(!c.priceMin||t.price>=c.priceMin)&&(!c.priceMax||t.price<=c.priceMax)&&(!c.areaMin||t.area>=c.areaMin)&&(!c.areaMax||t.area<=c.areaMax)&&(!((D=c.bedrooms)!=null&&D.length)||t.bedrooms&&c.bedrooms.includes(t.bedrooms))&&(!((A=c.district)!=null&&A.length)||c.district.includes(t.district));return r&&i})].sort((t,r)=>{let i,u;switch(n){case"price":i=t.price,u=r.price;break;case"area":i=t.area,u=r.area;break;case"created":i=new Date(t.createdAt).getTime(),u=new Date(r.createdAt).getTime();break;case"views":i=t.views,u=r.views;break;case"priority":const k={urgent:4,high:3,medium:2,low:1};i=k[t.priority],u=k[r.priority];break;default:return 0}return m==="desc"?u-i:i-u}),R=t=>{const r=L.has(t),i=new Set(L);r?i.delete(t):i.add(t),_(i),f==null||f(t,!r)},U=t=>({apartment:"Căn hộ",house:"Nhà riêng",villa:"Biệt thự",townhouse:"Nhà phố",office:"Văn phòng",shop:"Mặt bằng",warehouse:"Kho bãi",land:"Đất nền",resort:"Resort",hotel:"Khách sạn"})[t]||t,W=t=>({available:"bg-green-100 text-green-800",sold:"bg-red-100 text-red-800",rented:"bg-blue-100 text-blue-800",reserved:"bg-yellow-100 text-yellow-800",pending:"bg-orange-100 text-orange-800",expired:"bg-gray-100 text-gray-800",draft:"bg-purple-100 text-purple-800"})[t]||"bg-gray-100 text-gray-800",J=t=>({available:"Có sẵn",sold:"Đã bán",rented:"Đã thuê",reserved:"Đã đặt cọc",pending:"Đang xử lý",expired:"Hết hạn",draft:"Nháp"})[t]||t,Y=t=>({urgent:"text-red-600",high:"text-orange-600",medium:"text-blue-600",low:"text-green-600"})[t],Z=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(t);return b?a("div",{className:"space-y-6",children:[a("div",{className:"animate-pulse",children:[e("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((t,r)=>a("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 animate-pulse",children:[e("div",{className:"h-48 bg-gray-200 rounded mb-4"}),e("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]},r))})]}):a("div",{className:"space-y-6",children:[a("div",{className:"flex items-center justify-between",children:[a("div",{children:[e("h1",{className:"text-2xl font-semibold text-gray-900",children:"Quản lý Bất động sản"}),a("p",{className:"text-gray-600 mt-1",children:["Tổng cộng ",$.length," bất động sản"]})]}),a("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[e(ee,{className:"w-4 h-4"}),e("span",{children:"Thêm BĐS"})]})]}),a("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[a("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[a("div",{className:"relative flex-1 max-w-md",children:[e(V,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e("input",{type:"text",placeholder:"Tìm kiếm bất động sản...",value:o,onChange:t=>S(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a("div",{className:"flex items-center space-x-4",children:[a("button",{onClick:()=>C(!p),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e(te,{className:"w-4 h-4"}),e("span",{children:"Bộ lọc"})]}),a("select",{value:n,onChange:t=>d(t.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e("option",{value:"created",children:"Mới nhất"}),e("option",{value:"price",children:"Giá"}),e("option",{value:"area",children:"Diện tích"}),e("option",{value:"views",children:"Lượt xem"}),e("option",{value:"priority",children:"Ưu tiên"})]}),e("button",{onClick:()=>H(m==="asc"?"desc":"asc"),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:e(ae,{className:`w-4 h-4 ${m==="desc"?"rotate-180":""}`})}),a("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:()=>l("grid"),className:`p-2 rounded-lg ${x==="grid"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:e(se,{className:"w-4 h-4"})}),e("button",{onClick:()=>l("list"),className:`p-2 rounded-lg ${x==="list"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:e(re,{className:"w-4 h-4"})})]})]})]}),p&&a(B.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-gray-200",children:[a("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loại BĐS"}),a("select",{multiple:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",onChange:t=>{const r=Array.from(t.target.selectedOptions,i=>i.value);w(i=>({...i,type:r}))},children:[e("option",{value:"apartment",children:"Căn hộ"}),e("option",{value:"house",children:"Nhà riêng"}),e("option",{value:"villa",children:"Biệt thự"}),e("option",{value:"townhouse",children:"Nhà phố"}),e("option",{value:"land",children:"Đất nền"}),e("option",{value:"shop",children:"Mặt bằng"})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khoảng giá"}),a("div",{className:"flex space-x-2",children:[e("input",{type:"number",placeholder:"Từ",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",onChange:t=>w(r=>({...r,priceMin:t.target.value?Number(t.target.value):void 0}))}),e("input",{type:"number",placeholder:"Đến",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",onChange:t=>w(r=>({...r,priceMax:t.target.value?Number(t.target.value):void 0}))})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Diện tích (m²)"}),a("div",{className:"flex space-x-2",children:[e("input",{type:"number",placeholder:"Từ",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",onChange:t=>w(r=>({...r,areaMin:t.target.value?Number(t.target.value):void 0}))}),e("input",{type:"number",placeholder:"Đến",className:"w-full border border-gray-300 rounded px-2 py-1 text-sm",onChange:t=>w(r=>({...r,areaMax:t.target.value?Number(t.target.value):void 0}))})]})]}),a("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số phòng ngủ"}),a("select",{multiple:!0,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",onChange:t=>{const r=Array.from(t.target.selectedOptions,i=>Number(i.value));w(i=>({...i,bedrooms:r}))},children:[e("option",{value:"1",children:"1 PN"}),e("option",{value:"2",children:"2 PN"}),e("option",{value:"3",children:"3 PN"}),e("option",{value:"4",children:"4 PN"}),e("option",{value:"5",children:"5+ PN"})]})]})]}),e("div",{className:"flex items-center justify-end space-x-2 mt-4",children:e("button",{onClick:()=>w({}),className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"Xóa bộ lọc"})})]})]}),$.length===0?a("div",{className:"text-center py-12",children:[e("div",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",children:e(V,{className:"w-full h-full"})}),e("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Không tìm thấy bất động sản"}),e("p",{className:"mt-1 text-sm text-gray-500",children:o||Object.keys(c).length>0?"Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc.":"Bắt đầu bằng cách thêm bất động sản mới."}),!o&&Object.keys(c).length===0&&e("div",{className:"mt-6",children:e("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Thêm bất động sản đầu tiên"})})]}):e("div",{className:x==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:$.map(t=>e(ne,{property:t,viewMode:x,isFavorite:L.has(t.id),onView:()=>P(t),onEdit:()=>v(t),onDelete:()=>N(t.id),onToggleFavorite:()=>R(t.id),formatPrice:Z,getPropertyTypeText:U,getStatusColor:W,getStatusText:J,getPriorityColor:Y},t.id))})]})},ne=({property:s,viewMode:b,isFavorite:g,onView:v,onEdit:N,onDelete:P,onToggleFavorite:f,formatPrice:o,getPropertyTypeText:S,getStatusColor:p,getStatusText:C,getPriorityColor:x})=>{const l=s.images.find(n=>n.isPrimary)||s.images[0];return b==="list"?e(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:a("div",{className:"flex items-start space-x-6",children:[e("div",{className:"flex-shrink-0",children:e("div",{className:"w-32 h-24 bg-gray-200 rounded-lg overflow-hidden",children:l?e("img",{src:l.url,alt:s.title,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e("span",{className:"text-gray-400",children:"No image"})})})}),a("div",{className:"flex-1 min-w-0",children:[a("div",{className:"flex items-start justify-between",children:[a("div",{children:[e("h3",{className:"text-lg font-medium text-gray-900 truncate",children:s.title}),a("div",{className:"mt-1 flex items-center space-x-4 text-sm text-gray-500",children:[a("span",{className:"flex items-center",children:[e(F,{className:"w-4 h-4 mr-1"}),s.district]}),s.bedrooms&&a("span",{className:"flex items-center",children:[e(K,{className:"w-4 h-4 mr-1"}),s.bedrooms," PN"]}),s.bathrooms&&a("span",{className:"flex items-center",children:[e(q,{className:"w-4 h-4 mr-1"}),s.bathrooms," PT"]}),a("span",{className:"flex items-center",children:[e(X,{className:"w-4 h-4 mr-1"}),s.area,"m²"]})]})]}),a("div",{className:"flex items-center space-x-2",children:[e("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p(s.status)}`,children:C(s.status)}),e(Q,{className:`w-4 h-4 ${x(s.priority)}`})]})]}),a("div",{className:"mt-2 flex items-center justify-between",children:[a("div",{children:[e("p",{className:"text-lg font-semibold text-green-600",children:o(s.price)}),s.pricePerSqm&&a("p",{className:"text-sm text-gray-500",children:[o(s.pricePerSqm),"/m²"]})]}),a("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[a("span",{className:"flex items-center",children:[e(j,{className:"w-4 h-4 mr-1"}),s.views]}),a("span",{className:"flex items-center",children:[e(M,{className:"w-4 h-4 mr-1"}),s.favorites]})]})]}),a("div",{className:"mt-4 flex items-center justify-between",children:[a("div",{className:"text-sm text-gray-500",children:[e("span",{children:"Cập nhật: "}),E(new Date(s.updatedAt),{addSuffix:!0,locale:O})]}),a("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:f,className:`p-2 rounded-lg ${g?"text-red-600 bg-red-50":"text-gray-400 hover:text-red-600"}`,children:e(M,{className:`w-4 h-4 ${g?"fill-current":""}`})}),e("button",{onClick:v,className:"text-blue-600 hover:text-blue-700",title:"Xem chi tiết",children:e(j,{className:"w-4 h-4"})}),e("button",{onClick:N,className:"text-green-600 hover:text-green-700",title:"Chỉnh sửa",children:e(z,{className:"w-4 h-4"})}),e("button",{onClick:P,className:"text-red-600 hover:text-red-700",title:"Xóa",children:e(G,{className:"w-4 h-4"})})]})]})]})]})}):a(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:[a("div",{className:"relative h-48 bg-gray-200",children:[l?e("img",{src:l.url,alt:s.title,className:"w-full h-full object-cover"}):e("div",{className:"w-full h-full flex items-center justify-center",children:e("span",{className:"text-gray-400",children:"No image"})}),s.priority==="urgent"&&e("div",{className:"absolute top-2 left-2",children:e("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Khẩn cấp"})}),e("button",{onClick:f,className:`absolute top-2 right-2 p-2 rounded-full bg-white shadow-sm ${g?"text-red-600":"text-gray-400 hover:text-red-600"}`,children:e(M,{className:`w-4 h-4 ${g?"fill-current":""}`})}),s.featured&&e("div",{className:"absolute top-2 left-1/2 transform -translate-x-1/2",children:e("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Nổi bật"})})]}),a("div",{className:"p-4",children:[a("div",{className:"flex items-start justify-between mb-2",children:[e("h3",{className:"text-lg font-medium text-gray-900 truncate flex-1",children:s.title}),e("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p(s.status)}`,children:C(s.status)})]}),a("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[e(F,{className:"w-4 h-4 mr-1"}),e("span",{className:"truncate",children:s.address})]}),a("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:[e("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:S(s.type)}),a("div",{className:"flex items-center space-x-3",children:[s.bedrooms&&a("span",{className:"flex items-center",children:[e(K,{className:"w-4 h-4 mr-1"}),s.bedrooms]}),s.bathrooms&&a("span",{className:"flex items-center",children:[e(q,{className:"w-4 h-4 mr-1"}),s.bathrooms]}),a("span",{className:"flex items-center",children:[e(X,{className:"w-4 h-4 mr-1"}),s.area,"m²"]})]})]}),a("div",{className:"mb-3",children:[e("p",{className:"text-lg font-semibold text-green-600",children:o(s.price)}),s.pricePerSqm&&a("p",{className:"text-sm text-gray-500",children:[o(s.pricePerSqm),"/m²"]})]}),a("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[a("div",{className:"flex items-center space-x-3",children:[a("span",{className:"flex items-center",children:[e(j,{className:"w-4 h-4 mr-1"}),s.views]}),a("span",{className:"flex items-center",children:[e(M,{className:"w-4 h-4 mr-1"}),s.favorites]}),a("span",{className:"flex items-center",children:[e(le,{className:"w-4 h-4 mr-1"}),s.inquiries]})]}),e(Q,{className:`w-4 h-4 ${x(s.priority)}`})]}),a("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200",children:[e("div",{className:"text-xs text-gray-500",children:E(new Date(s.updatedAt),{addSuffix:!0,locale:O})}),a("div",{className:"flex items-center space-x-2",children:[e("button",{onClick:v,className:"text-blue-600 hover:text-blue-700",title:"Xem chi tiết",children:e(j,{className:"w-4 h-4"})}),e("button",{onClick:N,className:"text-green-600 hover:text-green-700",title:"Chỉnh sửa",children:e(z,{className:"w-4 h-4"})}),e("button",{onClick:P,className:"text-red-600 hover:text-red-700",title:"Xóa",children:e(G,{className:"w-4 h-4"})})]})]})]})]})},ge=()=>{const[s,b]=h.useState([]),[g,v]=h.useState(!0),[N,P]=h.useState({page:1,limit:12,total:0});h.useEffect(()=>{f()},[N.page]);const f=async l=>{try{v(!0);const n={page:N.page,limit:N.limit,sortBy:"created",sortOrder:"desc",...l},d=await T.getProperties(n);b(d.properties),P(m=>({...m,total:d.total,page:d.page,limit:d.limit}))}catch(n){console.error("Error loading properties:",n),y.error("Không thể tải danh sách bất động sản")}finally{v(!1)}},o=()=>{y.success("Tính năng thêm bất động sản đang được phát triển!")},S=l=>{y.info(`Chỉnh sửa bất động sản: ${l.title}`)},p=async l=>{if(confirm("Bạn có chắc chắn muốn xóa bất động sản này?"))try{await T.deleteProperty(l),b(n=>n.filter(d=>d.id!==l)),y.success("Đã xóa bất động sản thành công")}catch(n){console.error("Error deleting property:",n),y.error("Không thể xóa bất động sản")}},C=async l=>{try{await T.incrementPropertyViews(l.id),b(n=>n.map(d=>d.id===l.id?{...d,views:d.views+1}:d))}catch(n){console.error("Error incrementing views:",n)}y.info(`Xem chi tiết: ${l.title}`)},x=async(l,n)=>{try{await T.togglePropertyFavorite(l,n),b(d=>d.map(m=>m.id===l?{...m,favorites:n?m.favorites+1:Math.max(0,m.favorites-1)}:m))}catch(d){console.error("Error toggling favorite:",d),y.error("Không thể cập nhật trạng thái yêu thích")}};return g&&s.length===0?e("div",{className:"min-h-screen flex items-center justify-center",children:e(I,{size:"lg"})}):e("div",{className:"min-h-screen bg-gray-50 p-6",children:e(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto",children:e(ie,{properties:s,loading:g,onAddProperty:o,onEditProperty:S,onDeleteProperty:p,onViewProperty:C,onToggleFavorite:x})})})};export{ge as default};
