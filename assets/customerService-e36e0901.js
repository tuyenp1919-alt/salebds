const o=[{id:"1",name:"Nguyễn Văn An",email:"nguyenvanan@gmail.com",phone:"0901234567",company:"Công ty ABC",position:"Giám đốc",address:"Quận 1, TP. Hồ Chí Minh",status:"lead",priority:"high",source:"Facebook",notes:"Quan tâm đến dự án căn hộ cao cấp",totalValue:5e9,tags:["VIP","Căn hộ"],createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-20"),lastContactedAt:new Date("2024-01-18")},{id:"2",name:"Trần Thị Bình",email:"tranthibinh@yahoo.com",phone:"0912345678",company:"Công ty XYZ",position:"Trưởng phòng",address:"Quận 7, TP. Hồ Chí Minh",status:"prospect",priority:"medium",source:"Google Ads",notes:"Đang tìm hiểu về nhà phố liền kề",totalValue:3e9,tags:["Nhà phố","Gia đình"],createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-19"),lastContactedAt:new Date("2024-01-17")},{id:"3",name:"Lê Minh Cường",email:"leminhcuong@outlook.com",phone:"0923456789",company:null,position:null,address:"Quận Tân Bình, TP. Hồ Chí Minh",status:"customer",priority:"high",source:"Giới thiệu",notes:"Đã mua căn hộ 3PN, quan tâm đầu tư thêm",totalValue:8e9,tags:["Đầu tư","Căn hộ","VIP"],createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-21"),lastContactedAt:new Date("2024-01-19")},{id:"4",name:"Phạm Thị Dung",email:"phamthidung@gmail.com",phone:"0934567890",company:"Startup DEF",position:"Co-founder",address:"Quận 2, TP. Hồ Chí Minh",status:"lead",priority:"low",source:"Zalo",notes:"Quan tâm đến văn phòng nhỏ",totalValue:15e8,tags:["Văn phòng","Startup"],createdAt:new Date("2024-01-12"),updatedAt:new Date("2024-01-16"),lastContactedAt:null},{id:"5",name:"Hoàng Văn Em",email:"hoangvanem@hotmail.com",phone:"0945678901",company:"Ngân hàng GHI",position:"Chuyên viên",address:"Quận 9, TP. Hồ Chí Minh",status:"inactive",priority:"low",source:"Website",notes:"Đã liên hệ nhưng không phản hồi",totalValue:0,tags:["Không phản hồi"],createdAt:new Date("2024-01-08"),updatedAt:new Date("2024-01-14"),lastContactedAt:new Date("2024-01-12")}],d=t=>new Promise(e=>setTimeout(e,t)),g={async getCustomers(t){await d(500);let e=[...o];if(t!=null&&t.search){const a=t.search.toLowerCase();e=e.filter(s=>{var r;return s.name.toLowerCase().includes(a)||s.email.toLowerCase().includes(a)||s.phone.includes(a)||((r=s.company)==null?void 0:r.toLowerCase().includes(a))})}t!=null&&t.status&&t.status!=="all"&&(e=e.filter(a=>a.status===t.status)),t!=null&&t.priority&&t.priority!=="all"&&(e=e.filter(a=>a.priority===t.priority)),t!=null&&t.sortBy&&e.sort((a,s)=>{let r,c;switch(t.sortBy){case"name":r=a.name.toLowerCase(),c=s.name.toLowerCase();break;case"created":r=new Date(a.createdAt).getTime(),c=new Date(s.createdAt).getTime();break;case"lastContact":r=a.lastContactedAt?new Date(a.lastContactedAt).getTime():0,c=s.lastContactedAt?new Date(s.lastContactedAt).getTime():0;break;case"value":r=a.totalValue||0,c=s.totalValue||0;break;default:return 0}return r<c?t.sortOrder==="desc"?1:-1:r>c?t.sortOrder==="desc"?-1:1:0});const n=(t==null?void 0:t.page)||1,i=(t==null?void 0:t.limit)||10,l=(n-1)*i,u=l+i;return{customers:e.slice(l,u),total:e.length,page:n,limit:i}},async getCustomer(t){return await d(300),o.find(e=>e.id===t)||null},async getCustomerById(t){return this.getCustomer(t)},async createCustomer(t){await d(800);const e={...t,id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return o.unshift(e),e},async updateCustomer(t,e){await d(800);const n=o.findIndex(l=>l.id===t);if(n===-1)throw new Error("Không tìm thấy khách hàng");const i={...o[n],...e,updatedAt:new Date};return o[n]=i,i},async deleteCustomer(t){await d(500);const e=o.findIndex(n=>n.id===t);if(e===-1)throw new Error("Không tìm thấy khách hàng");o.splice(e,1)},async updateLastContact(t,e=new Date){await d(300);const n=o.findIndex(l=>l.id===t);if(n===-1)throw new Error("Không tìm thấy khách hàng");const i={...o[n],lastContactedAt:e,updatedAt:new Date};return o[n]=i,i},async searchCustomers(t){await d(600);let e=[...o];return t.name&&(e=e.filter(n=>n.name.toLowerCase().includes(t.name.toLowerCase()))),t.email&&(e=e.filter(n=>n.email.toLowerCase().includes(t.email.toLowerCase()))),t.phone&&(e=e.filter(n=>n.phone.includes(t.phone))),t.tags&&t.tags.length>0&&(e=e.filter(n=>t.tags.some(i=>{var l;return(l=n.tags)==null?void 0:l.includes(i)}))),t.status&&t.status.length>0&&(e=e.filter(n=>t.status.includes(n.status))),t.priority&&t.priority.length>0&&(e=e.filter(n=>t.priority.includes(n.priority))),t.createdFrom&&(e=e.filter(n=>new Date(n.createdAt)>=t.createdFrom)),t.createdTo&&(e=e.filter(n=>new Date(n.createdAt)<=t.createdTo)),t.valueFrom!==void 0&&(e=e.filter(n=>(n.totalValue||0)>=t.valueFrom)),t.valueTo!==void 0&&(e=e.filter(n=>(n.totalValue||0)<=t.valueTo)),e},async getCustomerStats(){await d(400);const t={total:o.length,byStatus:{},byPriority:{},bySource:{},totalValue:0,averageValue:0,recentCount:0},e=new Date;return e.setDate(e.getDate()-30),o.forEach(n=>{t.byStatus[n.status]=(t.byStatus[n.status]||0)+1,t.byPriority[n.priority]=(t.byPriority[n.priority]||0)+1,n.source&&(t.bySource[n.source]=(t.bySource[n.source]||0)+1),t.totalValue+=n.totalValue||0,new Date(n.createdAt)>=e&&t.recentCount++}),t.averageValue=t.total>0?t.totalValue/t.total:0,t}};export{g as c};
